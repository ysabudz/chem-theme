<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Universal Chemical Lab</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß™</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --wood: #4e342e; --wood-trim: #795548; --ink: #2b2d42; --danger: #ff4757; --accent: #6c5ce7; --gold: #ffd700; }

        body {
            margin: 0; min-height: 100vh;
            display: flex; align-items: center; justify-content: center;
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4, #a1c4fd, #ffd1ff);
            background-size: 400% 400%;
            animation: fluidMotion 10s ease infinite;
            padding: 15px; box-sizing: border-box;
            overflow-x: hidden;
        }

        @keyframes fluidMotion { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        /* --- THE FLEX BOX --- */
        .main-container {
            display: flex;
            flex-direction: column; /* Mobile */
            gap: 20px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(25px);
            border-radius: 40px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 25px 50px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 450px;
            transition: all 0.3s ease;
        }

        @media (min-width: 900px) {
            .main-container {
                flex-direction: row; /* Laptop */
                max-width: 1050px;
                padding: 40px;
                align-items: flex-start;
            }
            .beaker-zone { flex: 0 0 320px; }
            .cabinet-box { flex: 1; }
        }

        .beaker-zone { display: flex; flex-direction: column; align-items: center; gap: 15px; width: 100%; }
        .cabinet-box { display: flex; flex-direction: column; align-items: center; gap: 15px; width: 100%; min-width: 0; }

        /* BEAKER */
        .beaker {
            width: 130px; height: 170px; border: 4px solid var(--ink);
            border-radius: 0 0 50px 50px; position: relative;
            background: rgba(255, 255, 255, 0.7); overflow: hidden;
        }
        .liquid { position: absolute; bottom: 0; width: 100%; height: 0%; transition: all 0.7s ease; z-index: 2; }
        .bubble { position: absolute; background: rgba(255,255,255,0.4); border-radius: 50%; bottom: 0; animation: rise 2s infinite ease-in; z-index: 3; }
        @keyframes rise { 0% { transform: translateY(0) scale(0.5); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(-130px) scale(1.2); opacity: 0; } }

        /* CABINET */
        .cabinet {
            width: 100%; height: 260px; background: var(--wood);
            border: 10px solid var(--wood-trim); border-radius: 25px; padding: 20px;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8); display: flex; align-items: center; box-sizing: border-box;
        }
        .scroll-rack { display: flex; flex-direction: row; gap: 15px; overflow-x: auto; width: 100%; padding-bottom: 20px; align-items: flex-end; }
        .tube {
            flex: 0 0 65px; height: 160px; border: 2px solid rgba(255,255,255,0.2);
            border-radius: 0 0 35px 35px; cursor: pointer; position: relative;
            background: rgba(255,255,255,0.1); display: flex; align-items: flex-end; transition: 0.3s;
        }
        .tube:hover { transform: translateY(-10px); border-color: white; }
        .id-label { position: absolute; top: 10px; width: 100%; text-align: center; color: white; font-weight: bold; font-family: 'Space Mono'; text-shadow: 1px 1px 3px #000; font-size: 14px; }

        /* UI ELEMENTS */
        .terminal-box { width: 100%; height: 130px; background: rgba(255, 255, 255, 0.9); border-radius: 20px; border: 2px solid var(--ink); overflow-y: auto; }
        #msg { font-family: 'Space Mono'; font-size: 11px; color: var(--ink); padding: 15px; text-align: center; white-space: pre-line; }
        .btn-group { display: flex; gap: 10px; width: 100%; }
        button { font-family: 'Space Mono'; background: var(--ink); color: white; border: none; padding: 12px; border-radius: 12px; cursor: pointer; font-weight: bold; flex: 1; }
        .lock-btn { background: #00b894; flex: 2; }
        .danger-text { color: var(--danger) !important; font-weight: bold; animation: textShake 0.1s infinite; display: inline-block; }
        @keyframes textShake { 0%{transform:translateX(1px)} 100%{transform:translateX(-1px)} }

        /* CHAOS */
        .shaking { animation: shake 0.1s infinite; }
        @keyframes shake { 0% { transform: translate(4px, 4px); } 50% { transform: translate(-4px, -3px); } 100% { transform: translate(2px, 3px); } }
        #boom-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, #ff4757, transparent); opacity: 0; pointer-events: none; z-index: 99; transition: 0.3s; }
        .fire-flash { box-shadow: 0 0 50px #ff4757 !important; border-color: #ff4757 !important; }

        /* MODAL */
        #catalog-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); display: none; align-items: center; justify-content: center; z-index: 200; }
        .modal-content { background: white; padding: 30px; border-radius: 30px; width: 90%; max-width: 400px; max-height: 80vh; overflow-y: auto; text-align: center; }
    </style>
</head>
<body>

    <div id="catalog-modal">
        <div class="modal-content">
            <h3>üß™ Reagent Catalog</h3>
            <div id="reagent-list" style="text-align: left; font-family: 'Space Mono'; font-size: 11px;"></div>
            <button onclick="closeCatalog()" style="margin-top:20px; background:var(--accent)">Close</button>
        </div>
    </div>

    <div id="boom-overlay"></div>

    <div class="main-container" id="shaker">
        <div class="beaker-zone">
            <h2>[OUTPUT]</h2>
            <div class="beaker" id="beaker-box">
                <div class="liquid" id="fill"></div>
                <div id="bubble-wrap"></div>
            </div>
            <div class="terminal-box"><div id="msg">LAB READY.</div></div>
            <div class="btn-group">
                <button onclick="resetLab('flush')">FLUSH</button>
                <button onclick="openCatalog()" style="background:var(--accent); max-width:50px;">üîç</button>
                <button class="lock-btn" onclick="lockIn()">MIX IT!</button>
            </div>
        </div>

        <div class="cabinet-box">
            <h2>[REAGENTS]</h2>
            <div class="cabinet">
                <div class="scroll-rack" id="shelf"></div>
            </div>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(f, t, d, v, r = true) {
            const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
            o.type = t; o.frequency.setValueAtTime(f, audioCtx.currentTime);
            if(r) o.frequency.exponentialRampToValueAtTime(10, audioCtx.currentTime + d);
            g.gain.setValueAtTime(v, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + d);
            o.connect(g); g.connect(audioCtx.destination);
            o.start(); o.stop(audioCtx.currentTime + d);
        }

        const reagents = [
            {id: 'Cf', name: 'Brew-tal-Coffee', color: '#4b3832'},
            {id: 'Ms', name: 'Matcha-Shot', color: '#8eb021'},
            {id: 'Ch', name: 'Chismis-Acid', color: '#ff7675'},
            {id: 'De', name: 'Delulu-Oxide', color: '#fd79a8'},
            {id: 'Bc', name: 'Brain-Cell', color: '#55efc4'},
            {id: 'Em', name: 'Emo-Essence', color: '#4a148c'},
            {id: 'An', name: 'Annoying-Acid', color: '#f1c40f'},
            {id: 'Lu', name: 'Laughtose', color: '#ffeaa7'},
            {id: 'Sl', name: 'Sleep-Dep', color: '#a29bfe'},
            {id: 'Cp', name: 'Couch-Potato', color: '#8d6e63'},
            {id: 'Gh', name: 'Ghosted-Gas', color: '#dfe6e9'},
            {id: 'Os', name: 'Over-Sharer', color: '#ff8a65'},
            {id: 'Rb', name: 'Roast-Brom', color: '#636e72'},
            {id: 'Vb', name: 'Vibe-Cyanide', color: '#81ecec'},
            {id: 'Cr', name: 'Cringe-Iodine', color: '#a29bfe'}
        ];

        const duoResults = {
            "Cf+Sl": "Coffee vs Sleep Deprivation. Coffee is winning..... for now.",
            "Ms+Vb": "Matcha and Chill. Very demure, very mindful.",
            "Cf+Ch": "Coffee and Chismis. Bestest combo for chika sessions--therefore, we should go to cafes more often.",
            "Bc+Bc": "Two brain cells working together. A *miracle!*",
            "Cf+Ms": "My indecision and your... well... it created this...",
            "De+Sl": "So tired that you think you should shift courses, but you shall not!",
            "An+Rb": "You're annoying. Stop hating me :(",
            "Gh+Os": "I'm the oversharer and you're the ghoster. We don't talk, but we understand each other.",
            "Lu+Rb": "Everything is funny when I'm being mean to you <3",
            "Vb+Cp": "This so you--when there's no exams of course. Wish you could be more chill again..."
        };

        const secretTrios = {
            "Cf+Os+Ch": "Coffee, Chismis, and Over-Sharing. You've basically leaked the entire government's secrets by now.",
            "Ms+De+Em": "Matcha + Delulu + Emo. Crying about chemistry in a cute cafe while looking aesthetic.",
            "Cf+Sl+Bc": "One coffee, one brain cell, zero sleep. Godspeed.",
            "Bc+Bc+Bc": "3 Brain-Cells. Now THAT is a miracle. You are a genius.",
            "An+Bc+Lu": "Annoying, smart, and funny. You send me laughs and eye-rolls. Fair.",
            "Gh+Sl+Vb": "Ghosted, Sleep-Dep, but a Vibe. Yup, that's more you.",
            "An+Cr+Gh": "KABOOGSH!!! üí•\n 'F**k you' I say as I get mad at you for being annoying, cringe, and ghosting me.",
            "Ch+Ch+Ch": "KABOOGSH!!! üí•\nToo much chika! The servers are overheating.",
            "Ms+Ms+Ms": "ZEN OVERLOAD: You have become one with the matcha. You are now a leaf.",
            "Cf+Cf+Cf": "KABOOGSH!!! üí•\nThe beaker is vibrating from the caffeine! 400 BPM!",
            "Bc+De+Em": "KABOOGSH!!! üí•\nDelulu-Emo spiral killed the brain cells.",
            "Em+Rb+Sl": "KABOOGSH!!! üí•\nStop judging people... you are as emo and tired as them.",
            "Cr+Cr+Os": "KABOOGSH!!! üí•\nYou overshare blackmail-worthy info. I am keeping it.",
            "Lu+Lu+Lu": "Laughtose Overload! We laugh too much at this point. <3"
        };

        const shelf = document.getElementById('shelf');
        reagents.forEach(r => {
            const d = document.createElement('div'); d.className = 'tube';
            d.onclick = () => add(r);
            d.innerHTML = `<div class="id-label">${r.id}</div><div style="height:75%;width:100%;background:${r.color};opacity:0.8;"></div>`;
            shelf.appendChild(d);
            document.getElementById('reagent-list').innerHTML += `<div><strong>${r.id}</strong>: ${r.name}</div>`;
        });

        function openCatalog() { document.getElementById('catalog-modal').style.display='flex'; }
        function closeCatalog() { document.getElementById('catalog-modal').style.display='none'; }

        let mix = [];
        function add(r) {
            if (mix.length < 3) {
                if (audioCtx.state === 'suspended') audioCtx.resume();
                playSound(400 + (mix.length * 100), 'sine', 0.1, 0.2);
                mix.push(r);
                document.getElementById('fill').style.height = (mix.length * 33.3) + "%";
                document.getElementById('fill').style.background = r.color;
                document.getElementById('msg').innerText = `ADDING: ${r.name}...`;
                createBubbles(8);
            }
        }

        function createBubbles(c) {
            for(let i=0; i<c; i++){
                const b = document.createElement('div'); b.className='bubble';
                b.style.width=b.style.height= (Math.random()*10+5)+'px';
                b.style.left=Math.random()*100+'%';
                document.getElementById('bubble-wrap').appendChild(b);
                setTimeout(()=>b.remove(), 2000);
            }
        }

        function lockIn() {
            if (mix.length < 2) return;
            const ids = mix.map(m=>m.id).sort().join('+');
            let result = mix.length === 2 ? duoResults[ids] : secretTrios[ids];
            if (!result && mix.length === 3) result = "KABOOGSH!!! üí•\nUNSTABLE MIX!";

            if (result && result.includes("KABOOGSH")) {
                playSound(100, 'sawtooth', 0.8, 0.3);
                document.getElementById('msg').innerHTML = `<span class="danger-text">${result}</span>`;
                document.getElementById('shaker').classList.add('shaking');
                document.getElementById('beaker-box').classList.add('fire-flash');
                document.getElementById('boom-overlay').style.opacity = "0.6";
                setTimeout(() => resetLab('boom'), 4500);
            } else {
                playSound(800, 'sine', 0.1, 0.1, false);
                document.getElementById('msg').innerText = result;
            }
        }

        function resetLab(t) {
            mix=[]; document.getElementById('fill').style.height="0%";
            document.getElementById('msg').innerText = t==='flush' ? "FLUSHED." : "STATION RESET.";
            document.getElementById('shaker').classList.remove('shaking');
            document.getElementById('beaker-box').classList.remove('fire-flash');
            document.getElementById('boom-overlay').style.opacity = "0";
            document.getElementById('bubble-wrap').innerHTML = "";
        }
    </script>
</body>
</html>
